<!DOCTYPE html>
<html  lang="en">
<head>
  <!-- Site made with Mobirise Website Builder v6.1.4, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v6.1.4, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/western-mindanao-state-university-128x128.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Ranking</title>
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css?v=EGyIrj"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css?v=EGyIrj" type="text/css">

  
  
  
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu5 cid-uYhMtBFPZc" once="menu" id="menu05-70">
	

	<nav class="navbar navbar-dropdown navbar-expand-lg">
		<div class="container">
			<div class="navbar-brand">
				<span class="navbar-logo">
					
						<a href="index.html"><img src="assets/images/western-mindanao-state-university-260x260.png" alt="WMSU Logo" style="height: 3.4rem;"></a>
					
				</span>
				<span class="navbar-caption-wrap"><a class="navbar-caption text-black display-4" href="https://mobiri.se">WMSU Palaro 2025<br>Online Live Scoreboard</a></span>
			</div>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
				<div class="hamburger">
					<span></span>
					<span></span>
					<span></span>
					<span></span>
				</div>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item">
						<a class="nav-link link text-black text-primary display-4" href="page1.html">Home</a>
					</li><li class="nav-item">
						<a class="nav-link link text-black text-primary display-4" href="page2.html" aria-expanded="false">General</a>
					</li><li class="nav-item">
						<a class="nav-link link text-black text-primary display-4" href="page3.html">College</a>
					</li><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="page24.html">Ranking</a></li></ul>
				
			</div>
		</div>
	</nav>
</section>

<section data-bs-version="5.1" class="article11 cid-uYhMtBXgcL" id="article11-71">
    

    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-4">
                
                
                
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="header12 cid-uYhMtCeUhc" id="header12-72">
  
  

  <div class="text-center container">
    <div class="row mb-4 justify-content-center">
      <div class="col-12 col-md-4">
        <img class="w-100" src="assets/images/western-mindanao-state-university-260x260.png" alt="WMSU Logo">
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-md-12 content-head">
        <h1 class="mbr-section-title mbr-fonts-style mb-4 display-5">
          <strong>WMSU Palaro 2025</strong></h1>
        <p class="mbr-text mbr-fonts-style mb-4 display-2"><strong>
          Overall Ranking</strong></p>
        
      </div>
    </div>
  </div>
</section>

<section data-bs-version="5.1" class="content4 cid-uYhMtCuqnf" id="custom-html-73">
    <div class="mbr-overlay" style="opacity: 0.7; background-color: #ffffff;"></div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <div id="sports-container" class="sports-container d-flex flex-wrap justify-content-center">
                    <!-- Intramural games will load here dynamically -->
                </div>
            </div>
        </div>
    </div>
</section><style class="cid-uYhMtCuqnf" id="custom-html-73" data-rv-view="591">
    .sports-container {
        display: flex;
        flex-direction: column; /* Stack sports vertically */
        align-items: center;    /* Center the sports */
        width: 100%;
    }
    .sport-group {
        display: flex;
        justify-content: center;
        flex-wrap: wrap; /* Allow wrapping to next line */
        gap: 20px; /* Space between cards */
        margin-bottom: 30px; /* Space between sport groups */
        max-width: 100%;
        width: 100%;
    }
    .team-card {
        width: 100%;
        max-width: 100%;
        margin: 0 auto 15px auto; /* Ensure consistent spacing */
        box-sizing: border-box;
    }

    /* Animation for rank change */
    @keyframes rankChangeHighlight {
        0% {
            background-color: #ffff99;
            transform: scale(1.05);
        }
        50% {
            background-color: #fff;
            transform: scale(1);
        }
        100% {
            background-color: #f9f9f9;
            transform: scale(1);
        }
    }

    .rank-changed {
        animation: rankChangeHighlight 1.5s ease forwards;
    }

    /* Rank circle styles */
    .rank-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        color: white;
        font-weight: bold;
        font-size: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        user-select: none;
    }

    /* Define colors for different rank levels */
    .rank-1 {
        background-color: #FFD700; /* Gold */
        color: #333; /* Dark text for contrast */
        box-shadow: 0 0 8px #FFD700AA;
    }

    .rank-2 {
        background-color: #C0C0C0; /* Silver */
        color: #333;
        box-shadow: 0 0 8px #C0C0C0AA;
    }

    .rank-3 {
        background-color: #CD7F32; /* Bronze */
        color: white;
        box-shadow: 0 0 8px #CD7F32AA;
    }

    .rank-top5 {
        background-color: #2196F3; /* Blue for ranks 4-5 */
        color: white;
        box-shadow: 0 0 8px #2196F3AA;
    }

    .rank-other {
        background-color: #999999; /* Gray for others */
        color: white;
        box-shadow: none;
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
        .sports-container {
            padding: 0 10px; /* Add padding for edges */
        }
        .sport-group {
            gap: 0; /* Remove gap on mobile since cards are full-width */
            margin-bottom: 20px;
        }
        .team-card {
            margin-bottom: 20px;
            padding: 15px; /* Reduce padding slightly */
        }
        /* Adjust card internal layout for mobile */
        .team-card > div:first-child {
            flex-direction: column; /* Stack left and right on mobile */
            align-items: flex-start;
            gap: 10px;
        }
        .team-card > div:first-child > div:first-child {
            flex-direction: row; /* Keep logo and name horizontal */
            align-items: center;
            width: 100%;
        }
        .team-card img {
            width: 50px !important; /* Smaller logo on mobile */
            height: 50px !important;
            margin-right: 10px;
        }
        .team-card > div:first-child > div:first-child > div {
            font-size: 20px !important; /* Slightly smaller team name */
        }
        /* Stack medals vertically on very small screens */
        @media (max-width: 480px) {
            .team-card > div:first-child > div:last-child {
                flex-direction: column;
                align-items: center;
                gap: 10px;
                width: 100%;
            }
            .team-card > div:first-child > div:last-child > div:first-child {
                flex-direction: row;
                justify-content: center;
                gap: 15px;
                flex-wrap: wrap;
            }
            .team-card > div:first-child > div:last-child > div:last-child {
                width: 100%;
                text-align: center;
                margin-top: 10px;
            }
            .team-card > div:first-child > div:last-child > div:last-child div:last-child {
                font-size: 28px !important; /* Adjust points size */
            }
        }
        /* Smaller medals on mobile */
        .team-card > div:first-child > div:last-child > div:first-child > div {
            font-size: 20px !important; /* Emoji size */
        }
        .team-card > div:first-child > div:last-child > div:first-child > div:last-child {
            font-size: 18px !important; /* Medal count size */
        }
        /* Status bar adjustments */
        .team-card > div:last-child {
            font-size: 11px !important;
            text-align: center; /* Center on mobile */
        }
    }

    /* Tablet adjustments */
    @media (min-width: 769px) and (max-width: 992px) {
        .sport-group {
            gap: 15px;
        }
        .team-card {
            max-width: 48%; /* Two cards per row on tablet */
        }
    }
</style><script class="cid-uYhMtCuqnf" id="custom-html-73" data-rv-view="591">
    const sheetId = '1EJfto3fshSHuYLUwWLCb7JaDmFKQdXJlunMlyNOwYx8';  // Replace with your Google Sheet ID
    const apiKey = 'AIzaSyB1A4QxXCsSpXPvZ0SNeLtJs6GnJJO-JyQ';       // Replace with your Google Sheets API key
    const range = 'RANK!A2:D1000';                               // Adjusted range for Rank, Logo, Name, Points
    const updateInterval = 2000; // Update every 2 seconds

    const sheetUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

    let lastDataHash = null; // Store hash of last data to detect changes
    let lastRanks = {};      // Store last ranks by team name to detect rank changes

    function getDataHash(data) {
        // Create a simple hash of the data to detect changes
        return JSON.stringify(data);
    }

    // Determine rank class based on rank number
    function getRankClass(rank) {
        const rankNum = parseInt(rank, 10);
        if (rankNum === 1) return 'rank-1';
        if (rankNum === 2) return 'rank-2';
        if (rankNum === 3) return 'rank-3';
        if (rankNum >= 4 && rankNum <= 5) return 'rank-top5';
        return 'rank-other';
    }

    function loadGamesData() {
        console.log('Fetching data...');
        fetch(sheetUrl)
            .then(response => response.json())
            .then(data => {
                console.log('Data received:', data);
                const currentDataHash = getDataHash(data);
                
                if (currentDataHash === lastDataHash) {
                    console.log('No changes detected, skipping update');
                    return;
                }
                
                console.log('Data changed, updating display');
                lastDataHash = currentDataHash;
                
                const sportsContainer = document.getElementById('sports-container');
                const rows = data.values;

                if (!rows || rows.length === 0) {
                    sportsContainer.innerHTML = '<p style="color: #666; text-align: center; font-size: 1.2rem;">No teams currently active</p>';
                    lastRanks = {};
                    return;
                }

                // Build new content and track rank changes
                let newContent = '<div class="sport-group">';
                
                rows.forEach(row => {
                    while (row.length < 4) {
                        row.push('');
                    }
                    
                    const rank = row[0] || '-';
                    const teamLogo = row[2] || '';
                    const teamName = row[1] || 'Team';
                    const totalPoints = row[3] || '0';
                    const status = 'Active';

                    // Check if rank changed for this team
                    const prevRank = lastRanks[teamName];
                    const rankChanged = prevRank !== undefined && prevRank !== rank;

                    // Save current rank for next update
                    lastRanks[teamName] = rank;

                    // Add animation class if rank changed
                    const animationClass = rankChanged ? 'rank-changed' : '';

                    newContent += `
                        <div class="team-card ${animationClass}" style="padding: 20px; background-color: #f9f9f9; border-radius: 8px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">
                            <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                                <!-- Left side: Rank, Team logo and name -->
                                <div style="display: flex; align-items: center; flex: 1; min-width: 0; gap: 15px;">
                                    <div class="rank-circle ${getRankClass(rank)}" title="Rank #${rank}">
                                        ${rank}
                                    </div>
                                    ${teamLogo ? `<img src="${teamLogo}" alt="${teamName}" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid #ddd; flex-shrink: 0;">` : ''}
                                    <div style="font-size: 24px; font-weight: bold; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                        ${teamName}
                                    </div>
                                </div>
                                
                                <!-- Right side: Total Points -->
                                <div style="text-align: center; padding: 12px 18px; background-color: #e8f4f8; border-radius: 6px; border-left: 4px solid #2196F3; flex-shrink: 0; white-space: nowrap;">
                                    <div style="font-size: 14px; color: #666; margin-bottom: 4px;">TOTAL POINTS</div>
                                    <div style="font-size: 32px; font-weight: bold; color: #2196F3;">${totalPoints}</div>
                                </div>
                            </div>
                            
                            <!-- Status bar -->
                            <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee; font-size: 12px; color: #666; text-align: right;">
                                Status: ${status}
                            </div>
                        </div>
                    `;
                });
                
                newContent += '</div>';

                sportsContainer.innerHTML = newContent;

                // Remove animation class after animation ends to allow future animations
                const animatedCards = sportsContainer.querySelectorAll('.rank-changed');
                animatedCards.forEach(card => {
                    card.addEventListener('animationend', () => {
                        card.classList.remove('rank-changed');
                    }, { once: true });
                });

                console.log('DOM updated successfully');
            })
            .catch(error => {
                console.error('Error fetching data:', error);
                console.log('Keeping existing content due to fetch error');
            });
    }

    // Load data immediately
    loadGamesData();

    // Set up automatic updates
    setInterval(loadGamesData, updateInterval);
</script>

<section data-bs-version="5.1" class="article11 cid-uYhMtCHRHR" id="article11-74">
    

    
    
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mt-0 mb-0 display-2"><strong>Stay Updated.</strong></h3>
                
                
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="footer4 cid-uYhMtCZazZ" once="footers" id="footer04-75">

    

    

    <div class="container">
        <div class="media-container-row align-center mbr-white">
            <div class="col-12">
                <p class="mbr-text mb-0 mbr-fonts-style display-7">
                    © Copyright 2025 TUD - All Rights Reserved
                </p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="article11 cid-uYhMtDdfn2" id="article11-76">
    

    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                
                
                
            </div>
        </div>
    </div>
</section><section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap;    align-content: center;display: flex;position: relative;height: 4rem;"><a href="https://mobiri.se/3408938" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;"><img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></a><p style="margin: 0;text-align: center;" class="display-7">&#8204;</p><a style="z-index:1" href="https://mobirise.com/builder/ai-website-builder.html">AI Website Software</a></section><script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/theme/js/script.js"></script>  
  
  
</body>
</html>